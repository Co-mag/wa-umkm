<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <title>WakWak CMS</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="/images/uploads/favicon.png" />

  <!-- Custom CSS untuk seluruh admin -->
  <link rel="stylesheet" href="/admin/custom.css" />
</head>
<body>
  <!-- Inisialisasi DecapCMS -->
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>

  <script>
  const h = window.h || window.React?.createElement;

  const Badge = (text, cls) =>
    h('span', { className: `badge ${cls}` }, text);

  const ProdukPreview = ({ entry, widgetFor }) => {
    const d = entry.get('data') || new Map();
    const title = d.get('title') || 'Nama Produk';
    const price = d.get('price') || 0;
    const image = d.get('image') || '';
    const cat   = d.getIn(['detail','category']) || '';
    const stock = d.getIn(['detail','stock']) || 0;

    return h('article', { className:'produk-preview' }, [
      h('div', { className:'pp-head' }, [
        h('h2', {}, title),
        h('div', { className:'pp-badges' }, [
          Badge(`Rp ${Number(price||0).toLocaleString('id-ID')}`, 'price'),
          cat ? Badge(cat, 'cat') : null,
          Badge(`Stok ${stock||0}`, 'stock'),
        ])
      ]),
      image ? h('div', { className:'pp-imgWrap' }, [
        h('img', { src:image, alt:title })
      ]) : null,
      h('div', { className:'pp-body' }, widgetFor('body')),
    ]);
  };

  CMS.registerPreviewTemplate('produk', ProdukPreview);
  CMS.registerPreviewStyle('/admin/custom-preview.css');
    // Sisipkan footer custom sekali saja
  function injectFooter() {
    if (document.getElementById('custom-footer')) return;

    const f = document.createElement('div');
    f.id = 'custom-footer';
    f.setAttribute('role', 'contentinfo');
    // Tahun otomatis mengikuti device (kamu tetap bisa ganti manual jadi 2025)
    const year = new Date().getFullYear();
    f.innerHTML = `
      <div class="cf-wrap">
        <span class="cf-text">copyright &copy; ${year} widad</span>
      </div>
    `;
    document.body.appendChild(f);
  }

  // Panggil di berbagai momen (SPA)
  document.addEventListener('DOMContentLoaded', injectFooter);
  window.addEventListener('load', injectFooter);
  setTimeout(injectFooter, 800);
      </script>
</body>
</html>
